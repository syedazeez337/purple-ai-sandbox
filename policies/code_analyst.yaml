name: "secure-code-analyst"
description: "Scenario 1: Offline static analysis agent. High compute, strict isolation, no network."

filesystem:
  immutable_paths:
    - host_path: "/usr/bin"
      sandbox_path: "/usr/bin"
    - host_path: "/usr/lib"
      sandbox_path: "/usr/lib"
    - host_path: "/lib64"
      sandbox_path: "/lib64"
    - host_path: "/bin"
      sandbox_path: "/bin"
  scratch_paths:
    - "/tmp"
  output_paths:
    - host_path: "/tmp/purple/output/code-analyst"
      sandbox_path: "/output"
  working_dir: "/tmp"

syscalls:
  default_deny: false
  allow: []
  deny:
    - "socket"
    - "connect"
    - "bind"
    - "listen"
    - "accept"

resources:
  cpu_shares: 1.0
  memory_limit_bytes: "4G"
  pids_limit: 50
  session_timeout_seconds: 300

capabilities:
  default_drop: true
  add: []

network:
  isolated: true
  allow_outgoing: []
  allow_incoming: []

audit:
  enabled: true
  log_path: "/tmp/purple/audit/code-analyst.log"
  detail_level: ["syscall", "resource"]
