name: "production-secure"
description: "Scenario 4: High-assurance production. Read-only root, tight syscalls, no network."

filesystem:
  immutable_paths:
    - host_path: "/usr/bin"
      sandbox_path: "/usr/bin"
    - host_path: "/usr/lib"
      sandbox_path: "/usr/lib"
    - host_path: "/lib64"
      sandbox_path: "/lib64"
    - host_path: "/bin"
      sandbox_path: "/bin"
  scratch_paths:
    - "/tmp"
  output_paths:
    - host_path: "/tmp/purple/output/production"
      sandbox_path: "/var/log/app"
  working_dir: "/tmp"

syscalls:
  default_deny: true
  allow:
    - "read"
    - "write"
    - "openat"
    - "close"
    - "fstat"
    - "newfstatat"
    - "mmap"
    - "mprotect"
    - "munmap"
    - "brk"
    - "exit_group"
    - "rt_sigaction"
    - "rt_sigprocmask"
    - "arch_prctl"
    - "set_tid_address"
    - "rseq"
    - "getrandom"
    - "prlimit64"
    - "set_robust_list"
    - "getcwd"
    - "ioctl"
    - "getuid"
    - "getgid"
    - "geteuid"
    - "getegid"
    - "access"
    - "uname"
    - "sysinfo"
    - "fcntl"
    - "stat"
    - "readlink"
  deny: []

resources:
  cpu_shares: 0.5
  memory_limit_bytes: "256M"
  pids_limit: 10
  session_timeout_seconds: 3600

capabilities:
  default_drop: true
  add: []

network:
  isolated: true
  allow_outgoing: []
  allow_incoming: []

audit:
  enabled: true
  log_path: "/tmp/purple/audit/production.log"
  detail_level: ["syscall", "filesystem"]
