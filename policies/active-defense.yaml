name: "active-defense"
description: "Demonstrates Active Defense capabilities (eBPF Firewall)"

filesystem:
  immutable_paths:
    - host_path: "/usr/bin"
      sandbox_path: "/usr/bin"
    - host_path: "/usr/lib"
      sandbox_path: "/usr/lib"
    - host_path: "/usr/lib64"
      sandbox_path: "/usr/lib64"
    - host_path: "/bin"
      sandbox_path: "/bin"
    - host_path: "/lib"
      sandbox_path: "/lib"
    - host_path: "/lib64"
      sandbox_path: "/lib64"
  scratch_paths:
    - "/tmp"
  output_paths:
    - host_path: "/tmp/purple_test_scripts"
      sandbox_path: "/scripts"
  working_dir: "/tmp"

syscalls:
  default_deny: false
  allow: []
  deny: []

resources:
  cpu_shares: 1.0
  memory_limit_bytes: "200M" # Enforce strict memory
  pids_limit: 50
  block_io_limit: "100MBps"
  session_timeout_seconds: 60

capabilities:
  default_drop: true
  add: []
  drop: []

network:
  isolated: false         # Allow network by default...
  allow_outgoing: []
  allow_incoming: []
  blocked_ips:            # ...BUT block specific malicious IPs
    - "1.1.1.1"

audit:
  enabled: true
  log_path: "/tmp/active-defense.log"
  detail_level: ["network"]

ebpf_monitoring:
  enabled: true
  trace_syscalls: true
  trace_files: true
  trace_network: true
  correlation_enabled: false
