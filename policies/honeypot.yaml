name: "honeypot-research"
description: "Scenario 5: Honeypot. Permissive but strictly audited."

filesystem:
  immutable_paths:
    - host_path: "/usr/bin"
      sandbox_path: "/usr/bin"
    - host_path: "/usr/lib"
      sandbox_path: "/usr/lib"
    - host_path: "/lib64"
      sandbox_path: "/lib64"
    - host_path: "/bin"
      sandbox_path: "/bin"
  scratch_paths:
    - "/tmp"
  output_paths:
    - host_path: "/tmp/purple/output/honeypot"
      sandbox_path: "/secrets"
  working_dir: "/tmp"

syscalls:
  default_deny: false
  allow: []
  deny:
    # Core dangerous syscalls - always block these even in permissive mode
    - "mount"
    - "umount2"
    - "pivot_root"
    - "chroot"
    - "kexec_load"
    - "init_module"
    - "delete_module"
    - "finit_module"
    - "request_key"
    - "add_key"
    - "keyctl"
    - "ptrace"
    - "process_vm_readv"
    - "process_vm_writev"
    - "personality"
    - "reboot"
    - "settimeofday"
    - "adjtimex"
    - "clock_settime"
    - "sethostname"
    - "setdomainname"
    - "reboot"
    - "acct"
    - "quotactl"

resources:
  cpu_shares: 0.2
  memory_limit_bytes: "1G"
  pids_limit: 100
  session_timeout_seconds: 3600

capabilities:
  default_drop: true
  add: []

network:
  isolated: false
  allow_outgoing:
    - "80"
    - "443"
    - "22"
    - "21"
    - "53"
  allow_incoming: []
  blocked_ips:
    - "1.1.1.1"

audit:
  enabled: true
  log_path: "/tmp/purple/audit/honeypot.log"
  detail_level: ["syscall", "filesystem", "network", "resource"]

ebpf_monitoring:
  enabled: true
  trace_syscalls: true
  trace_files: true
  trace_network: true
