name: minimal-sandbox
description: Maximum security sandbox with absolute minimum privileges. Perfect for demonstrating Purple security capabilities and running untrusted code.

filesystem:
  immutable_paths:
    - host_path: /usr/lib
      sandbox_path: /usr/lib
    - host_path: /usr/lib64
      sandbox_path: /usr/lib64
    - host_path: /usr/bin/sh
      sandbox_path: /usr/bin/sh
    - host_path: /usr/bin/echo
      sandbox_path: /usr/bin/echo
    - host_path: /usr/bin/cat
      sandbox_path: /usr/bin/cat
    - host_path: /usr/bin/ls
      sandbox_path: /usr/bin/ls
    - host_path: /usr/bin/id
      sandbox_path: /usr/bin/id
    - host_path: /usr/bin/whoami
      sandbox_path: /usr/bin/whoami
    - host_path: /usr/bin/env
      sandbox_path: /usr/bin/env
    - host_path: /usr/bin/ping
      sandbox_path: /usr/bin/ping
    - host_path: /usr/bin/mount
      sandbox_path: /usr/bin/mount
    - host_path: /usr/bin/insmod
      sandbox_path: /usr/bin/insmod

  scratch_paths:
    - /tmp

  output_paths: []

  working_dir: /tmp

syscalls:
  default_deny: true

  allow:
    # File operations (supported by compiler)
    - read
    - write
    - openat
    - close
    - fstat
    - newfstatat
    - lseek
    # Memory
    - mmap
    - mprotect
    - munmap
    - brk
    # Process
    - execve
    - exit_group
    # System info
    - getuid
    - getgid
    - geteuid
    - getegid
    # Required
    - arch_prctl
    - set_tid_address
    - set_robust_list
    - rseq
    - prlimit64
    - getrandom
    - access
    - rt_sigaction
    - rt_sigprocmask
    - rt_sigreturn
    - fcntl
    - ioctl
    - stat
    - lstat
    - poll
    - pipe
    - prctl
    - capget
    - capset
    - getcwd
    - pread64
    - writev
    - getpid
    - getppid
    - gettid
    - getgroups
    - uname
    - futex
    - clock_gettime
    - readlinkat
    - getdents64
    - readlink
    - statfs
    - fstatfs
    - sysinfo
    - faccessat
    - faccessat2
    - socket
    - connect
    - dup
    - dup2
    - dup3

  deny:
    - mount
    - unmount
    - reboot
    - kexec_load
    - bpf
    - unlinkat
    - renameat2

resources:
  cpu_shares: 0.1
  memory_limit_bytes: 256M
  pids_limit: 5
  block_io_limit: 10MBps
  session_timeout_seconds: 60

capabilities:
  default_drop: true
  add: []

network:
  isolated: true
  allow_outgoing: []
  allow_incoming: []

audit:
  enabled: true
  log_path: /var/log/purple/minimal-sandbox.log
  detail_level:
    - syscall
    - filesystem
    - resource