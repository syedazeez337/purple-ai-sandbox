rd_("AjContains the success valueBgAI-specific features for Purple sandboxAhContains the error valueBhRun an AI agent with a specified profileCdList of capabilities to explicitly add (e.g., \xe2\x80\x9c\xe2\x80\xa6ChCreates a new Sandbox instance with a given compiled \xe2\x80\xa6BlCreates a new cgroup manager for the sandboxAlCreates a new SandboxManagerCaCreates a new resource pool with system resourcesAnInitialize Aiguard environmentAkList all available profilesBiShow detailed information about a profileBmLLM API cost calculation based on token usageCkList of syscalls to explicitly deny (overrides allow if \xe2\x80\xa6ChList of capabilities to drop when default_drop is false.AoReturns the argument unchanged.000000000000000000000000000000000000000000000000000000BaCalls <code>U::from(self)</code>.000000000000000000000000000000000000000000000000000000AcName of the profileAmName of the profile to deleteAkName of the profile to showBaGenerate audit correlation reportBeList of syscalls to explicitly allow.CaReset usage counters (for testing or new session)BcBudget limits for a sandbox sessionAdCreate a new profileA`Delete a profileCfTop-level policy configuration for an AI agent\xe2\x80\x99s \xe2\x80\xa6AnReplay a recorded eBPF sessionBaResult type for Purple operationsAlToken and cost budget limitsBeToken budget tracking and enforcementAlOutput format (json or text)B`Represents a single LLM API callAaIO-related errorsB`Monitor eBPF events in real-timeCbDatabase of model pricing (updated as of Dec 2024)oManage profilesCiThe main structure for managing a sandboxed execution \xe2\x80\xa6AmAdds a process to this cgroupBdCommand to execute with the AI agentCiCompiles a declarative Policy into a strict, internal \xe2\x80\xa6BkIf true, generate detailed JSON audit logs.B`If true, enable eBPF monitoring.CgExecutes the agent\xe2\x80\x99s command within the sandboxed \xe2\x80\xa6BgProfile to use for running the AI agentAmProfile to use for monitoringBkReleases resources from a completed sandboxAcSession ID to auditBbLog level for different componentsBeAllocates resources for a new sandboxCkIf true, the sandbox will have no network access (e.g., \xe2\x80\xa6AiAllowed LLM API providersBiPath to store audit logs within the host.AaSecurity settingsAoAI-specific policies (optional)CeAI-specific policies for LLM monitoring and budgetingCcCalculate cost for a specific model and token usageAjGet all recorded API callsAlGet current usage statisticsCgSet the logging level (trace, debug, info, warn, error)AnAI-specific policies from YAMLAdAudit logging errorsAkAggregated usage statisticsCnCPU share/limit (e.g., \xe2\x80\x9c1.0\xe2\x80\x9d for one CPU, or \xe2\x80\x9c0.5\xe2\x80\x9d \xe2\x80\xa6AjGet total usage statisticsAcMonitoring settingsBnParse cost string like \xe2\x80\x9c$10.00\xe2\x80\x9d into centsCkParses a port string into a valid port number (1-65535) \xe2\x80\xa6BdMaximum number of processes allowed.AdSession ID to replayAoDefines audit logging settings.AdCurrent budget usageAdConfiguration errorsBmA mapping from a host path to a sandbox path.AePolicy-related errorsCnCustom error type for Purple sandbox operations Note: Some \xe2\x80\xa6BeAI API monitor for tracking LLM callsAoMonitor and parse LLM API callsBgBlocked IP addresses (for eBPF filter).CjCustom DNS servers (e.g., [\xe2\x80\x9c8.8.8.8\xe2\x80\x9d, \xe2\x80\x9c1.1.1.1\xe2\x80\x9d]).AbCustom DNS serversBeFormat cost in cents as dollar stringAgGet pricing for a modelAkRate limiting configurationAbRecord an API callC`Enhanced logging macros for different subsystemsAkIf true, trace file access.CjSpecifies the working directory for the sandboxed process.AhCommand execution errorsBnPricing for a specific model (per 1000 tokens)AlNetwork configuration errorsBlManages resource allocation across sandboxesAhSandbox execution errorsAhSyscall filtering errorsCfIf true, all syscalls are denied by default unless \xe2\x80\xa6CkIf true, all capabilities are dropped by default unless \xe2\x80\xa6CeLevel of detail for logs (e.g., \xe2\x80\x9csyscall\xe2\x80\x9d, \xe2\x80\x9c\xe2\x80\xa6CjInitialize the logging system with the specified log levelAdGet all known modelsClList of paths that are output (write-only, review-gated) \xe2\x80\xa6BnManages cgroups for resource limit enforcementCnEnhanced error context for better debugging Note: Kept for \xe2\x80\xa6BmTracks LLM API calls during sandbox executionAmDefines network access rules.AeResource limit errorsAgResource usage trackingAkCurrent status of a sandboxBdDefines allowed and denied syscalls.CnParses an I/O rate string (e.g., \xe2\x80\x9c100MBps\xe2\x80\x9d, \xe2\x80\x9c1GBps\xe2\x80\x9d\xe2\x80\xa6CiList of paths that are scratch (writable, disposable) \xe2\x80\xa6BkSets up cgroups and applies resource limitsBcIf true, trace network connections.C`Validates a path for security issues Returns \xe2\x80\xa6BmTracks token usage and enforces budget limitsAnError type for budget exceededCkA strict, internal representation of a policy, directly \xe2\x80\xa6AgCalculate LLM API costsAfNamespace setup errorsBhDefines resource limits for the sandbox.BmManages multiple concurrent sandbox instancesAmAllowed incoming connections.CfAllowed outgoing connections (e.g., \xe2\x80\x9c8.8.8.8:53\xe2\x80\x9d).CkDisk I/O limits (TODO: More detailed structure for disk \xe2\x80\xa6BnBlocked IPv4 addresses for eBPF network filterBnBlocked IPv6 addresses for eBPF network filterBnCreates a new sandbox with resource allocationAiCheck if a model is knownAjLists all active sandboxesAhIf true, trace syscalls.AlCapability management errorsAkFilesystem operation errorsAkPermission/privilege errorsBlInformation about a running sandbox instanceBeBudget enforcer for cost/token limitsBiCleans up cgroups after sandbox executionAmCleans up a completed sandboxBheBPF monitoring configuration (optional)AmeBPF monitoring configurationBiExecutes a sandbox and returns the resultBkGets the cgroup path for process assignmentCkList of paths that are immutable (read-only) inside the \xe2\x80\xa6CdDefines Linux capabilities to be granted or dropped.B`Defines filesystem access rules.ChCheck if we can afford this usage, and update if allowedChSets up filesystem isolation with bind mounts and chrootAjSetup filesystem isolationBjCreates a secure read-only /sys filesystemBaShow correlation with LLM intentsBnCleans up resources and performs audit loggingBfDrops capabilities according to policy0ClParses a memory size string (e.g., \xe2\x80\x9c2G\xe2\x80\x9d, \xe2\x80\x9c512M\xe2\x80\x9d, \xe2\x80\xa6BaResource allocation for a sandboxB`Resource pool status informationChCreates a device node with specified permissions and \xe2\x80\xa6BaGets resource usage for a sandboxAlGets the status of a sandboxClSyscall name to number mapping for common syscalls Note: \xe2\x80\xa6BeCost per 1000 input tokens (in cents)CcMemory limit in bytes (e.g., \xe2\x80\x9c1G\xe2\x80\x9d, \xe2\x80\x9c512M\xe2\x80\x9d).AeCompiled audit rules.BjAllows incoming traffic to a specific portBjAllows outgoing traffic to a specific portCgIf true, enable correlation between LLM intents and \xe2\x80\xa6BmCreates a unique sandbox ID for cgroup namingCnChecks if any resource limits are specified in the policy. \xe2\x80\xa6BfCost per 1000 output tokens (in cents)BkVerifies current capabilities for debuggingBfDefines eBPF monitoring configuration.CgList of sensitive system paths that should never be \xe2\x80\xa6CkApplies seccomp filtering based on the compiled syscall \xe2\x80\xa6CkConverts a capability name string to a caps::Capability \xe2\x80\xa6AgCompiled network rules.DdCompiled syscall rules. Uses <code>BTreeSet</code> for efficient \xe2\x80\xa6C`Adds the current process to the specified cgroupBeApplies resource limits using cgroupsCeCalculate cost with fallback pricing if model unknownCgExecutes the agent command within the sandbox Note: \xe2\x80\xa6BaKills all processes in the cgroupB`Loads a policy from a YAML file.BdParse OpenAI API response and recordCjConverts syscall names to numbers for the policy Note: \xe2\x80\xa6CfCreates a new PID namespace. Processes inside this \xe2\x80\xa6ClValidates a sandbox-internal path (less restrictive than \xe2\x80\xa6BaWrites an audit log entry to diskAiCompiled resource limits.AgAllows loopback trafficCgPerforms cleanup and exits the child process gracefullyCgSyscalls to explicitly deny when default_deny=false \xe2\x80\xa6CjSets the NO_NEW_PRIVS flag to prevent privilege escalationCnCreates a new user namespace and maps the current user and \xe2\x80\xa6CfPrefixes that are forbidden for host path bindings \xe2\x80\xa6CcApplies network filtering rules based on the policy0BgApplies syscall filtering using seccompAkSession timeout in seconds.CmCreates a new mount namespace. This allows the sandbox to \xe2\x80\xa6AjCompiled capability rules.AjCompiled filesystem rules.CeActually drops all capabilities and sets bounding setCdCleans up orphaned cgroups from previous failed runsBaGets overall resource pool statusBgParse Anthropic API response and recordCbSets up the loopback interface in isolated networkCiSets up a panic hook to attempt cleanup on unexpected \xe2\x80\xa6CiVerifies that the current process is in the specified \xe2\x80\xa6BnAdds specific capabilities back to the processBiBlocks all network traffic using iptablesBhSets up default deny policy for iptablesClSets up loopback interface using direct ioctl calls This \xe2\x80\xa6CnCreates a new network namespace. This isolates the sandbox \xe2\x80\xa6CbConfigures a completely isolated network namespaceBlDrops specific capabilities from the processCeForce kills all processes in the cgroup using SIGKILLBmSets up signal handlers for the child processChCleans up orphaned filesystems from previous failed runsBnSets up signal handlers for the parent processBdDrop capabilities using system callsChValidates that cgroup functionality is available and \xe2\x80\xa6C`Configures selective network filtering using \xe2\x80\xa6")