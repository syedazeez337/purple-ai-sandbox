rd_("AjContains the success valueBgAI-specific features for Purple sandboxB`Comparison operation to perform.AhContains the error valueBhRun an AI agent with a specified profileCdList of capabilities to explicitly add (e.g., \xe2\x80\x9c\xe2\x80\xa6AbAudit all sessionsCcREST API handlers for correlation engine operationsCiArgument index (0-based) to check. For x86_64: 0=rax, \xe2\x80\xa6BfCLI integration for correlation engineAmCalculate interquartile rangeChCreates a new Sandbox instance with a given compiled \xe2\x80\xa6AlCreates a new SandboxManagerCaCreates a new resource pool with system resourcesBlCreates a new cgroup manager for the sandboxAfOpen or create storagejProcess IDBhInitialize Purple AI Sandbox environmentAjList all running sandboxesAkList all available profilesAdList active sessionsnList all rulesAiLoad rules from directoryBiShow detailed information about a profileAjStop and cleanup a sandboxBmLLM API cost calculation based on token usageCkList of syscalls to explicitly deny (overrides allow if \xe2\x80\xa6ChList of capabilities to drop when default_drop is false.AoReturns the argument unchanged.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BaCalls <code>U::from(self)</code>.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000kJSON outputCfOptional bitmask for masked comparisons (used with \xe2\x80\xa6AiCalculate mean of a sliceAcName of the profileAmName of the profile to deleteAkName of the profile to showBaGenerate audit correlation reportjEqual (==)0AlSubmit an event to a sessionAfManage detection rulesAoStart a new correlation sessionBeList of syscalls to explicitly allow.CaReset usage counters (for testing or new session)BbDetection rules engine supporting:AiValue to compare against.BcBudget limits for a sandbox sessionAdCreate a new sandboxAdCreate a new profileA`Delete a profileAfRegister an LLM intentCfTop-level policy configuration for an AI agent\xe2\x80\x99s \xe2\x80\xa6AnReplay a recorded eBPF sessionAmGenerate a correlation reportBaResult type for Purple operationsBeCheck status of a correlation sessionC`Action to take for this syscall (allow or deny).AlToken and cost budget limitsBeToken budget tracking and enforcementBnSandbox configuration for path externalizationBmUse direct sandbox execution (bypass manager)BbCore correlation engine providing:BkEnrich a raw event with additional metadataAlOutput format (json or text)mOutput format0BkCore data models for the correlation enginekUser promptBeUpdate baseline with new session dataB`Represents a single LLM API callA`Detected anomalyAgUnique event identifierAaIO-related errorsB`Monitor eBPF events in real-timeCbDatabase of model pricing (updated as of Dec 2024)oManage profilesCiThe main structure for managing a sandboxed execution \xe2\x80\xa6AkDisplay version informationAmAdds a process to this cgroupBdCommand to execute with the AI agentChCompact storage (note: sled doesn\xe2\x80\x99t have a compact \xe2\x80\xa6CiCompiles a declarative Policy into a strict, internal \xe2\x80\xa6mEvent detailsBkIf true, generate detailed JSON audit logs.B`If true, enable eBPF monitoring.BcCalculate entropy of a distributionCgExecutes the agent\xe2\x80\x99s command within the sandboxed \xe2\x80\xa6CgNetwork filtering and isolation for sandboxed executionBgProfile to use for running the AI agentAmProfile to use for monitoringAlProfile name for the sessionBkReleases resources from a completed sandboxCaSession ID to audit (use \xe2\x80\x93all for all sessions)ChPersistent storage layer for correlation data using sledBiName of the syscall this rule applies to.AmCalculate z-score for a valueAbAPI-related errorsD`API state - uses Arc&lt;Mutex&lt;\xe2\x80\xa6&gt;&gt; for Shareable stateBbComplete a session and get resultsBhEvidence supporting an anomaly detectionAhUnique intent identifierA`Less than (&lt;)0BbLog level for different componentsnNot equal (!=)0BnBase observed event from eBPF or other sourcesBhSeverity levels for events and anomaliesAaAdd a custom ruleBeAllocates resources for a new sandboxAkCheck if an IP is maliciousCkIf true, the sandbox will have no network access (e.g., \xe2\x80\xa6AiAllowed LLM API providersBiPath to store audit logs within the host.BgRollback all mounts (called on failure)AaSecurity settingsAkGet the sys filesystem pathBcsys filesystem path (default: /sys)AiLLM Intent representationCiOCSF (Open Cybersecurity Schema) compatible export formatAgRisk score type (0-100)AfResult of a rule matchBaManage multiple sandbox instancesAiUnique session identifierAiSigma rule format supportAiAdd a mount to be trackedAoAI-specific policies (optional)CeAI-specific policies for LLM monitoring and budgetingCcCalculate cost for a specific model and token usageoRules directoryAjGet all recorded API callsAlGet current usage statisticsCgSet the logging level (trace, debug, info, warn, error)AlGet the proc filesystem pathBeproc filesystem path (default: /proc)A`Start API serverAnAI-specific policies from YAMLAdAudit logging errorsAkAggregated usage statisticsBkCheck file hash against threat intelligenceCmConditions that must be met for this rule to apply. If no \xe2\x80\xa6CnCPU share/limit (e.g., \xe2\x80\x9c1.0\xe2\x80\x9d for one CPU, or \xe2\x80\x9c0.5\xe2\x80\x9d \xe2\x80\xa6BbEvent enrichment module providing:jEvent typeAjGet total usage statisticsBdLoads manager state from a JSON fileAcMonitoring settingsBnParse cost string like \xe2\x80\x9c$10.00\xe2\x80\x9d into centsCkParses a port string into a valid port number (1-65535) \xe2\x80\xa6BdMaximum number of processes allowed.AgSandbox ID to associateBbSaves manager state to a JSON fileAdSession ID to replayjSession ID0000ChSet the global sandbox configuration (for testing or \xe2\x80\xa6AlStatistical helper functionsAfStore a detection ruleBgTypes of anomalies that can be detectedAoDefines audit logging settings.AdCurrent budget usageCeComparison operation for syscall argument conditions.AdConfiguration errorsAmCorrelation engine operationsAcGreater than (&gt;)0CiMasked equal - value AND mask must equal comparison valueBoMasked equal - (value &amp; mask) == comparisonBmA mapping from a host path to a sandbox path.AePolicy-related errorsCnCustom error type for Purple sandbox operations Note: Some \xe2\x80\xa6AfDetection rules engineBeAI API monitor for tracking LLM callsAoMonitor and parse LLM API callsBgBlocked IP addresses (for eBPF filter).CiState-of-the-Art Correlation Engine for Purple AI SandboxCjCustom DNS servers (e.g., [\xe2\x80\x9c8.8.8.8\xe2\x80\x9d, \xe2\x80\x9c1.1.1.1\xe2\x80\x9d]).AbCustom DNS serversBeFormat cost in cents as dollar stringAgGet pricing for a modelAhRetrieve a session by IDAaGet session by IDBfMap a syscall to ATT&amp;CK techniquesB`Match an event against all rulesAkRate limiting configurationAbRecord an API callC`Enhanced logging macros for different subsystemsAgStore an enriched eventAkIf true, trace file access.CjSpecifies the working directory for the sandboxed process.AhCommand execution errorsBdCompiled rule for efficient matchingCfPersistable manager state (excludes active Sandbox \xe2\x80\xa6BnPricing for a specific model (per 1000 tokens)AlNetwork configuration errorsBlManages resource allocation across sandboxesAhSandbox execution errorsAhSyscall filtering errorsBhCheck domain against threat intelligenceAeCompile a single ruleCfIf true, all syscalls are denied by default unless \xe2\x80\xa6CkIf true, all capabilities are dropped by default unless \xe2\x80\xa6CeLevel of detail for logs (e.g., \xe2\x80\x9csyscall\xe2\x80\x9d, \xe2\x80\x9c\xe2\x80\xa6C`Check if current behavior deviates from baselineBaDuration from current time helperC`Convert from z-score magnitude to severity levelBjRetrieve behavioral baseline for a profileB`Reads I/O statistics from cgroupCjInitialize the logging system with the specified log levelAdGet all known modelsClList of paths that are output (write-only, review-gated) \xe2\x80\xa6CmRuns an iptables command with proper validation and error \xe2\x80\xa6BhGet the PATH variable for inside sandboxBiDefault PATH inside sandbox (default: \xe2\x80\xa6AnGet the sandbox root directoryCeSandbox root directory (default: /tmp/purple-sandbox)BnManages cgroups for resource limit enforcementCnEnhanced error context for better debugging Note: Kept for \xe2\x80\xa6BdEnriched event with correlation dataBcEvent categories for classificationCkEvent Enricher - adds metadata and classification to eventsBmTracks LLM API calls during sandbox executionAmIn-memory storage for testingAmDefines network access rules.AeResource limit errorsAgResource usage trackingCgSandbox configuration containing all configurable pathsAkCurrent status of a sandboxBbAction to take for a syscall rule.BdDefines allowed and denied syscalls.AlCreate API router with stateBiEvaluate a compiled rule against an eventAiRetrieve all stored rulesmGet all rulesBfReads CPU usage statistics from cgroupAlGet the iptables binary pathCbiptables binary path (default: /usr/sbin/iptables)BhHelper function to get current timestampCnParses an I/O rate string (e.g., \xe2\x80\x9c100MBps\xe2\x80\x9d, \xe2\x80\x9c1GBps\xe2\x80\x9d\xe2\x80\xa6AmProcess an incoming raw eventCiList of paths that are scratch (writable, disposable) \xe2\x80\xa6BkSets up cgroups and applies resource limitsAoStart a new correlation sessionAkStore a correlation sessionBcIf true, trace network connections.C`Validates a path for security issues Returns \xe2\x80\xa6BmTracks token usage and enforces budget limitsAnError type for budget exceededCkA strict, internal representation of a policy, directly \xe2\x80\xa6AgCalculate LLM API costsCdMasked not equal - value AND mask must not equal \xe2\x80\xa6CcMasked not equal - (value &amp; mask) != comparisonBoTracks a mount operation for potential rollbackAfNamespace setup errorsBhDefines resource limits for the sandbox.ClGlobal sandbox configuration - uses Lazy for thread-safe \xe2\x80\xa6BmManages multiple concurrent sandbox instancesCiAdvanced syscall rules with argument filtering. These \xe2\x80\xa6CmAdvanced syscall rules with argument filtering. These are \xe2\x80\xa6AmAllowed incoming connections.CfAllowed outgoing connections (e.g., \xe2\x80\x9c8.8.8.8:53\xe2\x80\x9d).CkDisk I/O limits (TODO: More detailed structure for disk \xe2\x80\xa6BnBlocked IPv4 addresses for eBPF network filterBnBlocked IPv6 addresses for eBPF network filterBnCreates a new sandbox with resource allocationAlDetect anomalies in an eventClGets the ScmpCompareOp for a given comparison type Note: \xe2\x80\xa6nGet rule countAiCheck if a model is knownAjLists all active sandboxesAgLoad a single rule fileAiStore behavioral baselineAhIf true, trace syscalls.BcATT&amp;CK technique mapping resultAlCapability management errorsAgDetected attack patternAkFilesystem operation errorsAjLess than or equal (&lt;=)0BkPattern detector for common attack patternsAkPermission/privilege errorsBlInformation about a running sandbox instanceC`Metadata about a sandbox instance (serializable)BcRepresents a known threat indicatorBeBudget enforcer for cost/token limitsBiCleans up cgroups after sandbox executionAmCleans up a completed sandboxBheBPF monitoring configuration (optional)AmeBPF monitoring configurationBiExecutes a sandbox and returns the resultBkGets the cgroup path for process assignmentBgGet a value from an event by field pathBcReads peak memory usage from cgroupCkList of paths that are immutable (read-only) inside the \xe2\x80\xa6AmCompile rules for performanceBfRegister an LLM intent for correlationoRolling averageCdDefines Linux capabilities to be granted or dropped.B`Defines filesystem access rules.BlSequence analyzer for ordered event patternsCgCondition that must be met for a syscall rule to apply.ChCheck if we can afford this usage, and update if allowedCcComplete a correlation session and generate resultsA`Expected actionsCkSafely create a file without following symlinks (TOCTOU \xe2\x80\xa6ChSets up filesystem isolation with bind mounts and chrootC`Setup filesystem isolation with rollback supportBaShow correlation with LLM intentsBdConfiguration for correlation engineAgMain correlation engineBjRecommended actions for detected anomaliesBnCleans up resources and performs audit loggingAnGet the default audit log pathC`Default audit log path (default: /tmp/audit.log)BfDrops capabilities according to policy0AhBuilt-in detection rulesAaGet session countClParses a memory size string (e.g., \xe2\x80\x9c2G\xe2\x80\x9d, \xe2\x80\x9c512M\xe2\x80\x9d, \xe2\x80\xa6CcConvert Sigma rule to internal DetectionRule formatCiValidates that iptables is available at the expected pathBaBehavioral baseline for a profileBiBehavioral features extracted from eventsCgCompiled comparison operation for efficient runtime \xe2\x80\xa6CnCorrelation session - container for a complete correlation \xe2\x80\xa6AmGreater than or equal (&gt;=)0BaResource allocation for a sandboxB`Resource pool status informationAdRisk score breakdownAmSeverity classification rulesAjGet the cgroup parent pathCcCgroup parent path (default: /sys/fs/cgroup/purple)BbGenerate cgroup path for a sandboxCjCreates a ScmpArgCompare from our internal comparison typeChCreates a device node with specified permissions and \xe2\x80\xa6CjDetect the root device major:minor numbers dynamically \xe2\x80\xa6BeEvaluate a condition against an eventBaGets resource usage for a sandboxAlGets the status of a sandboxAmRetrieve events for a sessionBeCost per 1000 input tokens (in cents)BlMap file operations to ATT&amp;CK techniquesCcMemory limit in bytes (e.g., \xe2\x80\x9c1G\xe2\x80\x9d, \xe2\x80\x9c512M\xe2\x80\x9d).CnRestores a SandboxManager from saved state (metadata only, \xe2\x80\xa6CaReturns whether shutdown was requested via signalAlCalculate standard deviationCfAdvanced syscall rule with argument filtering support.BiCurrent version of the correlation engineAeCompiled audit rules.CgIf true, enable correlation between LLM intents and \xe2\x80\xa6BaGet the default scratch directoryChDefault scratch directory inside sandbox (default: /tmp)AkDetect rate-based anomaliesClExecutes a sandbox via the manager (centralized resource \xe2\x80\xa6AmExport session to OCSF formatBmCreates a unique sandbox ID for cgroup namingAcGet active sessionsCnChecks if any resource limits are specified in the policy. \xe2\x80\xa6BfCost per 1000 output tokens (in cents)BeGenerate a sandbox-specific root pathCbValidates that an IP address is properly formattedBkVerifies current capabilities for debuggingB`MITRE ATT&amp;CK Mapping ServiceAgRequest/response modelsBfDefines eBPF monitoring configuration.CgList of sensitive system paths that should never be \xe2\x80\xa6ClApplies advanced syscall rules with conditional argument \xe2\x80\xa6CkApplies seccomp filtering based on the compiled syscall \xe2\x80\xa6BjCalculate overall risk score for a sessionCkConverts a capability name string to a caps::Capability \xe2\x80\xa6AeClean up old sessionsBaGet essential host paths to mountCkEssential host paths to mount (default: /usr/bin, /bin, \xe2\x80\xa6CgExtracts the comparison value from a CompiledComparisonCfValidates a DNS server string and returns valid IP \xe2\x80\xa6CgVerifies that an iptables rule was successfully appliedAgCompiled network rules.DdCompiled syscall rules. Uses <code>BTreeSet</code> for efficient \xe2\x80\xa6ChManages filesystem setup with rollback capability on \xe2\x80\xa6C`Adds the current process to the specified cgroupBeApplies resource limits using cgroupsCeCalculate cost with fallback pricing if model unknownCgExecutes the agent command within the sandbox Note: \xe2\x80\xa6BaKills all processes in the cgroupB`Loads a policy from a YAML file.BoMap network operations to ATT&amp;CK techniquesBdParse OpenAI API response and recordCfCreates a new PID namespace. Processes inside this \xe2\x80\xa6CkValidates a profile name for security Returns Ok(()) if \xe2\x80\xa6ClValidates a sandbox-internal path (less restrictive than \xe2\x80\xa6BaWrites an audit log entry to diskAiCompiled resource limits.CdSled-based persistent storage for correlation engineCgPerforms cleanup and exits the child process gracefullyCgSyscalls to explicitly deny when default_deny=false \xe2\x80\xa6ChHelper function to parse a size string with a suffix \xe2\x80\xa6CjSets the NO_NEW_PRIVS flag to prevent privilege escalationCnCreates a new user namespace and maps the current user and \xe2\x80\xa6BmTrait for correlation storage implementationsCfPrefixes that are forbidden for host path bindings \xe2\x80\xa6CcApplies network filtering rules based on the policy0BgApplies syscall filtering using seccompAkSession timeout in seconds.CmCreates a new mount namespace. This allows the sandbox to \xe2\x80\xa6AjCompiled capability rules.AjCompiled filesystem rules.CgCompiled syscall condition with resolved comparison \xe2\x80\xa6BaDefault correlation configurationCeActually drops all capabilities and sets bounding setCgBuilt-in check for known malicious IPs (limited sample)CdCleans up orphaned cgroups from previous failed runsBaGets overall resource pool statusAhList sessions by profileBgParse Anthropic API response and recordBcRemoves all network filtering rulesCiSets up a panic hook to attempt cleanup on unexpected \xe2\x80\xa6CiVerifies that the current process is in the specified \xe2\x80\xa6AkThreat intelligence serviceBnAdds specific capabilities back to the processAeLoad rules from filesCnCreates a new network namespace. This isolates the sandbox \xe2\x80\xa6CkValidate a path for symlink attacks (TOCTOU protection) \xe2\x80\xa6BiBuilt-in check for known malicious hashesCbConfigures a completely isolated network namespaceAkDetect statistical outliersBlDrops specific capabilities from the processChCompiled advanced syscall rule with resolved syscall \xe2\x80\xa6CjCreates a new sandbox from profile and command strings \xe2\x80\xa6CeForce kills all processes in the cgroup using SIGKILLBmSets up signal handlers for the child processBjBuilt-in check for known malicious domainsChCleans up orphaned filesystems from previous failed runsCgSets up signal handlers for the parent process with \xe2\x80\xa6BdDrop capabilities using system callsChValidates that cgroup functionality is available and \xe2\x80\xa6CiVerifies that essential bind mounts are visible after \xe2\x80\xa6CfConfigures selective network filtering based on policy")